â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  SISTEMA DE EXPORTACIÃ“N A EXCEL                             â•‘
â•‘                         Â¡INSTALADO Y LISTO!                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… INSTALACIÃ“N COMPLETADA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ LibrerÃ­a instalada: PhpSpreadsheet v1.30.0
ğŸ“‚ Dependencias: 10 paquetes instalados
ğŸ¯ Estado: FUNCIONAL


ğŸ¨ CARACTERÃSTICAS DEL REPORTE EXCEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

El archivo Excel generado incluye:

ğŸ“‹ DISEÃ‘O PROFESIONAL:
   âœ“ TÃ­tulo del reporte con fondo azul (#2E86AB)
   âœ“ Fecha de generaciÃ³n automÃ¡tica
   âœ“ Encabezados con fondo verde (#0C7C59)
   âœ“ Filas alternas con fondo gris claro
   âœ“ Bordes en todas las celdas
   âœ“ Textos centrados y alineados
   âœ“ Fuentes personalizadas (tamaÃ±os y negritas)

ğŸ“Š 40 COLUMNAS DE DATOS COMPLETOS:

   ğŸ”¹ INFORMACIÃ“N PERSONAL (10 campos):
      â€¢ ID del contrato
      â€¢ Fecha de diligenciamiento
      â€¢ Nombres y apellidos (separados y completo)
      â€¢ Tipo y nÃºmero de documento
      â€¢ Lugar de expediciÃ³n
      â€¢ Fecha de nacimiento y edad

   ğŸ”¹ DATOS DE CONTACTO (3 campos):
      â€¢ Correo electrÃ³nico
      â€¢ NÃºmero de celular
      â€¢ GÃ©nero

   ğŸ”¹ INFORMACIÃ“N SOCIAL (6 campos):
      â€¢ Grupo poblacional
      â€¢ Discapacidad (SÃ­/No y tipo)
      â€¢ Estado civil
      â€¢ Hijos (SÃ­/No y cantidad)

   ğŸ”¹ DATOS DE UBICACIÃ“N (3 campos):
      â€¢ DirecciÃ³n de residencia
      â€¢ Barrio
      â€¢ Municipio de residencia

   ğŸ”¹ INFORMACIÃ“N ACADÃ‰MICA (6 campos):
      â€¢ Nivel de estudios
      â€¢ TÃ­tulo obtenido
      â€¢ Tiene postgrado (SÃ­/No)
      â€¢ Tipo de postgrado
      â€¢ TÃ­tulo de postgrado

   ğŸ”¹ DATOS LABORALES (9 campos):
      â€¢ EPS
      â€¢ Fondo de pensiÃ³n
      â€¢ ARL
      â€¢ 5 municipios de trabajo
      â€¢ Experiencia laboral

   ğŸ”¹ AUDITORÃA (4 campos):
      â€¢ Estado (Activo/Inactivo)
      â€¢ Creado por
      â€¢ Fecha de creaciÃ³n
      â€¢ Actualizado por y fecha

âš™ï¸ FUNCIONALIDADES AVANZADAS:
   âœ“ Paneles congelados (encabezados siempre visibles al hacer scroll)
   âœ“ Filtros automÃ¡ticos en todas las columnas
   âœ“ Anchos de columna ajustados automÃ¡ticamente
   âœ“ Altura de filas optimizada
   âœ“ Total de registros al final
   âœ“ Propiedades del documento (autor, tÃ­tulo, descripciÃ³n)


ğŸ“ FORMATO DE DATOS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ Fechas: DD/MM/YYYY (formato colombiano)
âœ“ Valores booleanos: "SÃ­" / "No" (en lugar de 1/0)
âœ“ Texto capitalizado: Primera letra mayÃºscula
âœ“ Guiones bajos reemplazados por espacios
âœ“ Estado: "Activo" / "Inactivo"
âœ“ Campos vacÃ­os: Celdas en blanco (no NULL o --)


ğŸš€ CÃ“MO USAR:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Ingresa al sistema: http://localhost/contratos/
2. Usuario: admin | ContraseÃ±a: admin123
3. Ve al menÃº "Listar Contratos"
4. Haz clic en el botÃ³n "Exportar a Excel" (icono de Excel verde)
5. El archivo se descargarÃ¡ automÃ¡ticamente con el nombre:
   Contratos_Completo_2025-10-05_143025.xlsx


ğŸ“‚ ARCHIVOS RELACIONADOS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ controllers/exportar_controller.php  â†’ LÃ³gica de exportaciÃ³n
âœ“ views/contrato_listar.php            â†’ BotÃ³n de exportar
âœ“ composer.json                        â†’ ConfiguraciÃ³n de dependencias
âœ“ composer.lock                        â†’ Versiones instaladas
âœ“ vendor/                              â†’ LibrerÃ­as (PhpSpreadsheet)


ğŸ¯ VENTAJAS SOBRE CSV:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CSV anterior                   |  XLSX nuevo
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• | â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âŒ Sin estilos                 | âœ… Colores y negritas
âŒ Sin bordes                  | âœ… Bordes profesionales
âŒ Problemas con comas         | âœ… Celdas separadas correctamente
âŒ Se abre en Notepad          | âœ… Se abre directo en Excel
âŒ Sin filtros                 | âœ… Filtros automÃ¡ticos
âŒ Columnas desalineadas       | âœ… Auto-ajuste perfecto
âŒ Sin fÃ³rmulas                | âœ… Preparado para anÃ¡lisis
âŒ Fecha en formato ISO        | âœ… Formato DD/MM/YYYY


ğŸ’¾ TAMAÃ‘O DEL ARCHIVO:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

EstimaciÃ³n por cantidad de registros:

â€¢ 10 contratos   â†’ ~15 KB
â€¢ 50 contratos   â†’ ~30 KB
â€¢ 100 contratos  â†’ ~50 KB
â€¢ 500 contratos  â†’ ~200 KB
â€¢ 1000 contratos â†’ ~350 KB

(El formato XLSX es muy eficiente y comprime bien los datos)


ğŸ”’ SEGURIDAD:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ Requiere autenticaciÃ³n activa (sesiÃ³n iniciada)
âœ“ Solo exporta registros activos (estado = 1)
âœ“ NO incluye archivos adjuntos (solo metadatos)
âœ“ AuditorÃ­a: Se registra quiÃ©n creÃ³ cada contrato
âœ“ Caracteres especiales manejados correctamente
âœ“ InyecciÃ³n SQL prevenida (prepared statements)


ğŸ¨ PALETA DE COLORES UTILIZADA:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â€¢ Azul Principal:  #2E86AB (tÃ­tulos y resumen)
â€¢ Verde Secundario: #0C7C59 (encabezados)
â€¢ Gris Claro:      #F0F0F0 (filas alternas)
â€¢ Blanco:          #FFFFFF (texto sobre colores)
â€¢ Negro:           #000000 (bordes y texto normal)


ğŸ“Š EJEMPLO DE SALIDA:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REPORTE DE CONTRATOS - SECRETARÃA DE EDUCACIÃ“N RISARALDA  â”‚ (azul)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Fecha de generaciÃ³n: 05/10/2025 14:30:25                  â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ID â”‚  Fecha    â”‚ Nombres  â”‚ Apellidos â”‚ Tipo Doc â”‚   ...   â”‚ (verde)
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚05/01/2025 â”‚ Juan     â”‚ PÃ©rez     â”‚    CC    â”‚   ...   â”‚ (gris)
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2  â”‚06/01/2025 â”‚ MarÃ­a    â”‚ GarcÃ­a    â”‚    CC    â”‚   ...   â”‚ (blanco)
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3  â”‚07/01/2025 â”‚ Carlos   â”‚ LÃ³pez     â”‚    CC    â”‚   ...   â”‚ (gris)
â”œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             TOTAL DE REGISTROS: 3                           â”‚ (azul)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ğŸ”§ MANTENIMIENTO:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Para actualizar PhpSpreadsheet en el futuro:
   composer update phpoffice/phpspreadsheet

Para ver la versiÃ³n instalada:
   composer show phpoffice/phpspreadsheet

Para reinstalar si hay problemas:
   composer clear-cache
   rm -rf vendor
   composer install


âœ¨ CARACTERÃSTICAS TÃ‰CNICAS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â€¢ Motor: PhpSpreadsheet 1.30.0 (Ãºltima versiÃ³n estable)
â€¢ Formato: XLSX (Office Open XML)
â€¢ CodificaciÃ³n: UTF-8 (caracteres especiales correctos)
â€¢ Compatibilidad: Excel 2007+, LibreOffice, Google Sheets
â€¢ CompresiÃ³n: ZIP interno (archivos pequeÃ±os)
â€¢ LÃ­mites: Hasta 1,048,576 filas (mÃ¡s que suficiente)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              Â¡EL SISTEMA ESTÃ LISTO PARA EXPORTAR! ğŸ‰ğŸ“Š
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Haz clic en "Exportar a Excel" y disfruta de reportes profesionales
con todos los datos de los contratos en formato XLSX hermoso y funcional.

NO se incluyen archivos adjuntos, solo los datos completos de cada contrato.
