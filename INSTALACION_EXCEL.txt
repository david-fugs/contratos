â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    INSTRUCCIONES DE INSTALACIÃ“N                             â•‘
â•‘            EXPORTACIÃ“N A EXCEL CON PHPSPREADSHEET                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ PASO 1: INSTALAR COMPOSER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Composer es un gestor de dependencias para PHP que necesitamos para instalar
PhpSpreadsheet.

1. Descarga Composer desde: https://getcomposer.org/download/

2. Para Windows:
   - Descarga el instalador: Composer-Setup.exe
   - Ejecuta el instalador y sigue las instrucciones
   - Selecciona la ruta de tu php.exe (generalmente: C:\xampp\php\php.exe)

3. Verifica la instalaciÃ³n:
   - Abre PowerShell o CMD
   - Ejecuta: composer --version
   - DeberÃ­as ver algo como: Composer version 2.x.x


ğŸ“š PASO 2: INSTALAR PHPSPREADSHEET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Abre PowerShell o CMD como Administrador

2. Navega a la carpeta del proyecto:
   cd C:\xampp\htdocs\contratos

3. Instala PhpSpreadsheet con Composer:
   composer install

   NOTA: Si es la primera vez, Composer descargarÃ¡ las dependencias.
   Esto puede tardar unos minutos dependiendo de tu conexiÃ³n.

4. Verifica que se creÃ³ la carpeta "vendor" en tu proyecto:
   C:\xampp\htdocs\contratos\vendor\


âš™ï¸ PASO 3: VERIFICAR EXTENSIONES PHP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PhpSpreadsheet requiere algunas extensiones de PHP habilitadas:

1. Abre el archivo: C:\xampp\php\php.ini

2. Busca y asegÃºrate de que estas lÃ­neas NO tengan ";" al inicio:
   extension=zip
   extension=gd
   extension=xml
   extension=xmlwriter
   extension=xmlreader

3. Si alguna tiene ";", quÃ­talo para habilitarla

4. Reinicia Apache desde el panel de control de XAMPP


âœ… PASO 4: PROBAR LA EXPORTACIÃ“N
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Inicia sesiÃ³n en el sistema: http://localhost/contratos/

2. Ve a "Listar Contratos"

3. Haz clic en el botÃ³n "Exportar a Excel"

4. DeberÃ­as descargar un archivo .xlsx con:
   âœ“ TÃ­tulo del reporte con estilo
   âœ“ 40 columnas de datos
   âœ“ Encabezados con colores
   âœ“ Filas alternas con fondo gris
   âœ“ Bordes en todas las celdas
   âœ“ Filtros automÃ¡ticos
   âœ“ Columnas auto-ajustadas
   âœ“ Total de registros al final


ğŸ¨ CARACTERÃSTICAS DEL ARCHIVO EXCEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š Datos incluidos (40 columnas):
   â€¢ InformaciÃ³n Personal (10 campos)
   â€¢ Datos de Contacto (3 campos)
   â€¢ InformaciÃ³n Social (6 campos)
   â€¢ Datos AcadÃ©micos (6 campos)
   â€¢ InformaciÃ³n Laboral (9 campos)
   â€¢ Datos de AuditorÃ­a (4 campos)

ğŸ¨ Estilos aplicados:
   â€¢ TÃ­tulo: Fondo azul (#2E86AB), texto blanco, centrado
   â€¢ Encabezados: Fondo verde (#0C7C59), texto blanco, negrita
   â€¢ Filas alternas: Fondo gris claro (#F0F0F0)
   â€¢ Bordes: Todas las celdas con bordes delgados
   â€¢ Total: Fondo azul con texto blanco y negrita

ğŸ”§ Funcionalidades:
   â€¢ Paneles congelados (tÃ­tulo y encabezados siempre visibles)
   â€¢ Filtros automÃ¡ticos en todas las columnas
   â€¢ Anchos de columna ajustados automÃ¡ticamente
   â€¢ Formato de fechas: DD/MM/YYYY
   â€¢ Valores SÃ­/No en lugar de 1/0


ğŸ”§ SOLUCIÃ“N DE PROBLEMAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ Error: "Class 'PhpOffice\PhpSpreadsheet\Spreadsheet' not found"
   âœ Ejecuta: composer install
   âœ Verifica que existe: C:\xampp\htdocs\contratos\vendor\autoload.php

âŒ Error: "Call to undefined function mb_string..."
   âœ Habilita extension=mbstring en php.ini
   âœ Reinicia Apache

âŒ Error: "ZipArchive not found"
   âœ Habilita extension=zip en php.ini
   âœ Reinicia Apache

âŒ El archivo se descarga pero estÃ¡ corrupto
   âœ Verifica que no haya ningÃºn echo o var_dump antes del header
   âœ Revisa que no haya espacios en blanco al inicio de los archivos PHP

âŒ Composer no se reconoce como comando
   âœ Cierra y vuelve a abrir PowerShell/CMD
   âœ Verifica la instalaciÃ³n: composer --version
   âœ Agrega Composer al PATH manualmente si es necesario


ğŸ“ ESTRUCTURA DE ARCHIVOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

C:\xampp\htdocs\contratos\
â”œâ”€â”€ composer.json              â† ConfiguraciÃ³n de dependencias
â”œâ”€â”€ composer.lock              â† (Se crea automÃ¡ticamente)
â”œâ”€â”€ vendor\                    â† (Se crea automÃ¡ticamente)
â”‚   â”œâ”€â”€ autoload.php          â† Cargador automÃ¡tico
â”‚   â”œâ”€â”€ phpoffice\            â† LibrerÃ­a PhpSpreadsheet
â”‚   â””â”€â”€ ...
â”œâ”€â”€ controllers\
â”‚   â”œâ”€â”€ exportar_controller.php  â† Controlador de exportaciÃ³n
â”‚   â””â”€â”€ ...
â””â”€â”€ views\
    â”œâ”€â”€ contrato_listar.php    â† Vista con botÃ³n de exportar
    â””â”€â”€ ...


ğŸ’¡ COMANDOS ÃšTILES DE COMPOSER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

composer install        â†’ Instalar dependencias desde composer.json
composer update         â†’ Actualizar todas las dependencias
composer require <pkg>  â†’ Instalar una nueva dependencia
composer show           â†’ Ver todas las dependencias instaladas
composer dump-autoload  â†’ Regenerar el autoloader


ğŸ†˜ SOPORTE ADICIONAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“– DocumentaciÃ³n PhpSpreadsheet:
   https://phpspreadsheet.readthedocs.io/

ğŸ“– DocumentaciÃ³n Composer:
   https://getcomposer.org/doc/

ğŸ“§ Si tienes problemas, verifica:
   1. VersiÃ³n de PHP: php -v (debe ser >= 7.4)
   2. Extensiones PHP: php -m
   3. Logs de Apache: C:\xampp\apache\logs\error.log


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    Â¡LISTO PARA EXPORTAR! ğŸ‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
